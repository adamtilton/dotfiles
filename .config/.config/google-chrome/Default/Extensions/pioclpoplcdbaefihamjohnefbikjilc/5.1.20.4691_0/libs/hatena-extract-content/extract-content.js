if(typeof ExtractContentJS=="undefined"){var ExtractContentJS={}}(function(d){var g=d.Lib.Util;var a=d.Lib.A;var e=d.Lib.DOM;var f=g.inherit(function(k){var l=arguments[1]||0;var h=arguments[2]||{};var j=arguments[3]||1048576;var i={node:k,depth:l,inside:h};i.statistics=function(){var n=(e.text(k)||"").replace(/\s+/g," ");var m=n.length;return{text:n.substr(0,j),noLinkText:(h.link||h.form)?"":n,listTextLength:h.list?m:0,noListTextLength:h.list?0:m,linkCount:h.link?1:0,listCount:h.li?1:0,linkListCount:(h.li&&h.link)?1:0}};return i},{commonAncestor:function(){var h=a.map(arguments,function(i){return i.node});if(h.length<2){return h[0]}return a.reduce(h,function(i,j){return e.commonAncestor(i,j)})},mergeStatistics:function(i,h){var j={};for(var k in i){j[k]=i[k]+h[k]}return j}});var c=function(i){i=a.filter(i,function(j){var k=e.text(j.node)||"";k=k.replace(/\s+/g,"");return k.length!=0});var h={score:0,leaves:i};h.commonAncestor=function(){return f.commonAncestor.apply(null,h.leaves)};return h};var b=function(i){var h={_content:i};h.asLeaves=function(){return h._content};h.asNode=function(){if(h._node){return h._node}h._node=f.commonAncestor.apply(null,h._content);return h._node};h.asTextFragment=function(){if(h._textFragment){return h._textFragment}if(h._content.length<1){return""}h._textFragment=a.reduce(h._content,function(k,l){var j=e.text(l.node);j=j.replace(/^\s+/g,"").replace(/\s+$/g,"");j=j.replace(/\s+/g," ");return k+j},"");return h._textFragment};h.asText=function(){if(h._text){return h._text}var j=h.asNode();h._text=j?e.text(j):"";return h._text};h.toString=function(){return h.asTextFragment()};return h};d.LayeredExtractor=function(){var h={handler:arguments[0]||[],filter:arguments[1]||{}};h.factory={getHandler:function(i){if(typeof d.LayeredExtractor.Handler!="undefined"){return new d.LayeredExtractor.Handler[i]}return null}};h.addHandler=function(i){if(typeof i!="undefined"){h.handler.push(i)}return h};h.filterFor=function(i){};h.extract=function(p){var k=p.location.href;var m={title:p.title,url:p.location.href};var j=h.handler.length;for(var l=0;l<j;l++){var n=h.handler[l].extract(p,k,m);if(!n){continue}var o=h.filterFor(k);if(o){n=o.filter(n)}n=new b(n);if(!n.toString().length){continue}m.content=n;m.isSuccess=true;m.engine=m.engine||h.handler[l];break}return m};return h};d.LayeredExtractor.Handler={};d.LayeredExtractor.Handler.Heuristics=function(){var h={name:"Heuristics",content:[],opt:g.inherit(arguments[0],{threshold:60,minLength:30,factor:{decay:0.75,noBody:0.72,continuous:1.16},punctuationWeight:10,minNoLink:8,noListRatio:0.2,limit:{leaves:800,recursion:20,text:1048576},debug:false}),pat:g.inherit(arguments[1],{sep:["div","center","td","h1","h2"],waste:[/Copyright|All\s*Rights?\s*Reserved?/i],affiliate:[/amazon[a-z0-9\.\/\-\?&]+-22/i],list:["ul","dl","ol"],li:["li","dd"],a:["a"],form:["form"],noContent:["frameset"],ignore:["iframe","img","script","style","select","noscript",["div",{id:[/more/,/menu/,/side/,/navi/],className:[/more/,/menu/,/side/,/navi/]}]],ignoreStyle:{display:"none",visibility:"hidden"},punctuations:/[\u3002\u3001\uFF0E\uFF0C\uFF01\uFF1F]|\.[^A-Za-z0-9]|,[^0-9]|!|\?/})};var i=g.inherit(function(k){var j=new c(k);j.eliminateLinks=function(){var n=a.map(j.leaves,function(r){return r.statistics()});if(!n.length){return""}if(n.length==1){n=n[0]}else{n=a.reduce(n,function(r,s){return f.mergeStatistics(r,s)})}var q=n.noLinkText.length;var m=n.linkCount;var p=n.listTextLength;if(q<h.opt.minNoLink*m){return""}var o=n.linkListCount/(n.listCount||1);o*=o;var l=h.opt.noListRatio*o*p;if(q<l){return""}return n.noLinkText};j.noBodyRate=function(){var l=0;if(j.leaves.length>0){l+=a.reduce(j.leaves,function(m,n){return m+e.countMatchTagAttr(n.node,"a","href",h.pat.affiliate)},0)}l/=2;l+=a.reduce(h.pat.waste,function(m,n){return m+g.countMatch(j._nolink,n)},0);return l};j.calcScore=function(l,m){j._nolink=j.eliminateLinks();if(j._nolink.length<h.opt.minLength){return 0}var o=g.countMatch(j._nolink,h.pat.punctuations);o*=h.opt.punctuationWeight;o+=j._nolink.length;o*=l;var n=j.noBodyRate();o*=Math.pow(h.opt.factor.noBody,n);j._c=j.score=o;j._c1=o*m;return o};j.isAccepted=function(){return j._c>h.opt.threshold};j.isContinuous=function(){return j._c1>h.opt.threshold};j.merge=function(l){j.score+=l._c1;j.depth=Math.min(j.depth,l.depth);a.push(j.leaves,l.leaves);return j};return j},{split:function(n){var m=[];var l=[];var p=0;var k=h.opt.limit.text;var j=function(q){if(q&&l.length){m.push(new i(l));l=[]}};var o=function(s,u,t){if(p>=h.opt.limit.leaves){return m}if(u>=h.opt.limit.recursion){return m}if(s.nodeName=="#comment"){return m}if(e.matchTag(s,h.pat.ignore)){return m}if(e.matchStyle(s,h.pat.ignoreStyle)){return m}var q=s.childNodes;var z=h.pat.sep;var x=q.length;var r={form:t.form||e.matchTag(s,h.pat.form),link:t.link||e.matchTag(s,h.pat.a),list:t.list||e.matchTag(s,h.pat.list),li:t.li||e.matchTag(s,h.pat.li)};for(var v=0;v<x;v++){var y=q[v];var w=e.matchTag(y,z);j(w);o(y,u+1,r);j(w)}if(!x){p++;l.push(new f(s,u,r,k))}return m};o(n,0,{});j(true);return m}});h.extract=function(q){var u=function(w){return q.getElementsByTagName(w).length!=0};if(a.some(h.pat.noContent,u)){return h}var s=1;var o=1;var k=0;var r=[];var j=i.split(q.body);var t;var p=j.length;for(var n=0;n<p;n++){var m=j[n];if(t){o/=h.opt.factor.continuous}if(!m.calcScore(s,o)){continue}s*=h.opt.factor.decay;if(m.isAccepted()){if(m.isContinuous()&&t){t.merge(m)}else{t=m;r.push(m)}o=h.opt.factor.continuous}else{if(!t){s=1}}}h.blocks=r.sort(function(w,v){return v.score-w.score});var l=a.first(h.blocks);if(l){h.content=l.leaves}return h.content};return h};d.LayeredExtractor.Handler.GoogleAdSection=function(){var h={name:"GoogleAdSection",content:[],state:[],opt:g.inherit(arguments[0],{limit:{leaves:800,recursion:20},debug:false})};var i={ignore:/google_ad_section_start\(weight=ignore\)/i,section:/google_ad_section_start/i,end:/google_ad_section_end/i};var k=1;var j=2;h.inSection=function(){return a.last(h.state)==j};h.ignore=function(){h.state.push(k)};h.section=function(){h.state.push(j)};h.end=function(){if(h.state.length){h.state.pop()}};h.parse=function(o){var p=arguments[1]||0;if(o.nodeName=="#comment"){if(i.ignore.test(o.nodeValue)){h.ignore()}else{if(i.section.test(o.nodeValue)){h.section()}else{if(i.end.test(o.nodeValue)){h.end()}}}return}if(h.content.length>=h.opt.limit.leaves){return}if(p>=h.opt.limit.recursion){return}var n=o.childNodes;var l=n.length;for(var m=0;m<l;m++){var q=n[m];h.parse(q,p+1)}if(!l&&h.inSection()){h.content.push(new f(o,p))}return};h.extract=function(l){h.parse(l);h.blocks=[new c(h.content)];return h.content};return h}})(ExtractContentJS);